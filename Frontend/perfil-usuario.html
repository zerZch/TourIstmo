<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Perfil de Usuario - Jenna Smith</title>
    <link rel="stylesheet" href="css/global.css">
    <link rel="stylesheet" href="css/perfil-usuario.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
</head>
<body>
    <!-- Navbar Flotante -->
    <nav class="floating-navbar" id="navbar">
        <!-- Menú Izquierdo -->
        <div class="menu-left">
            <a href="#destino" class="nav-link">Destino</a>
            <a href="#planes" class="nav-link">Planes</a>
            <a href="#perfil" class="nav-link">Perfil</a>
        </div>
        <!-- Logo Central -->
        <div class="menu-center">
            <a href="#" class="menu-title">
                <img class="logo-icon" src="img/logo.svg" alt="">
                <span>TourIstmo</span>
            </a>
        </div>
        <!-- Menú Derecho -->
        <div class="menu-right">
            <a href="#login" class="cta-button-nav">Login</a>
        </div>
        <!-- Menú móvil hamburguesa -->
        <div class="mobile-menu-toggle" id="mobileToggle">
            <span></span>
            <span></span>
            <span></span>
        </div>
    </nav>

    <div class="container">
        <!-- Sidebar Izquierdo -->
        <aside class="sidebar">
            <!-- Información del Usuario -->
            <div class="user-info">
                <div class="user-avatar">
                    <img src="img/jenna.avif" alt="Jenna Smith">
                </div>
                <h1 class="user-name">Jenna Smith</h1>
                <p class="user-username">@jennasmith</p>
            </div>
        </aside>

        <!-- Contenido Principal -->
        <main class="main-content">
            <!-- Navegación de Destinos -->
            <nav class="destinations-nav">
                <h2>Destinos Guardados</h2>
                <div class="destinations-tabs">
                    <button class="tab-btn active" data-category="todos">Todos</button>
                    <button class="tab-btn" data-category="naturaleza">Naturaleza</button>
                    <button class="tab-btn" data-category="urbano">Urbano</button>
                    <button class="tab-btn" data-category="cultural">Cultural</button>
                    <button class="tab-btn" data-category="tropical">Tropical</button>
                </div>
            </nav>

            <!-- Grid de Destinos -->
            <section class="destinations-grid">
                <!-- El contenido será generado dinámicamente por JavaScript -->
            </section>

            <!-- Agregar mensaje de no resultados -->
            <div id="noResults" class="no-results" style="display: none;">
                <p><i data-lucide="search-x"></i> No se encontraron destinos para esta categoría.</p>
            </div>
        </main>
    </div>

    <!-- ===== Footer ===== -->
    <footer class="footer">
        <div class="footer-container">
            <div class="footer-grid">
                <!-- Logo y descripción -->
                <div class="footer-brand">
                    <a href="#" class="footer-logo">
                        <img class="logo-icon" src="img/logowhite.png" alt="">
                        <span class="footer-logo-text">TourIstmo</span>
                    </a>
                    <p class="footer-description">
                        Explora, comparte y disfruta de los mejores destinos turísticos de Panamá.
                        Tu aventura comienza aquí.
                    </p>
                </div>
                <!-- Navegación principal -->
                <div class="footer-section">
                    <h4>TourIstmo</h4>
                    <ul class="footer-links">
                        <li><a href="index.jsp">Inicio</a></li>
                        <li><a href="formulario.jsp">Agregar Destino</a></li>
                        <li><a href="planes.jsp">Planes Turísticos</a></li>
                        <li><a href="#">Blog</a></li>
                        <li><a href="#">Reservar</a></li>
                    </ul>
                </div>
                <!-- Colaboración y Soporte -->
                <div class="footer-section">
                    <h4>Colabora</h4>
                    <ul class="footer-links">
                        <li><a href="#">Únete al equipo</a></li>
                        <li><a href="#">Publica tus planes</a></li>
                    </ul>
                    <h4 style="margin-top: var(--spacing-lg);">Soporte</h4>
                    <ul class="footer-links">
                        <li><a href="#">Términos y Condiciones</a></li>
                        <li><a href="#">Privacidad</a></li>
                        <li><a href="#">Ayuda</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p class="footer-copyright">
                    © 2025 Touristmo. Todos los derechos reservados.
                </p>
            </div>
        </div>
    </footer>
    <script>
        // ============================================
        // DATOS DE EJEMPLO - AJUSTADOS A BASE DE DATOS
        // ============================================
        // Sitios guardados del usuario (adaptado a la estructura de BD)
        const sitiosGuardados = [
            {
                id: 1,
                nombre: "Biomuseo",
                descripcion: "Museo dedicado a la biodiversidad de Panamá, diseñado por Frank Gehry. Una experiencia única que combina ciencia, arte y arquitectura.",
                imagen: "https://images.unsplash.com/photo-1566073771259-6a8506099945?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80",
                ubicacion: "Panamá, Panamá",
                precio: "$25",
                rating: "4.5",
                tipo: "Cultural",
                horario: "9:00 AM - 5:00 PM",
                ubicacion_mapa_url: "https://maps.google.com/?q=Biomuseo+Panama",
                favorito: true
            },
            {
                id: 2,
                nombre: "Casco Viejo",
                descripcion: "Barrio histórico de la Ciudad de Panamá, declarado Patrimonio de la Humanidad por la UNESCO. Arquitectura colonial y moderna se mezclan en este emblemático lugar.",
                imagen: "https://images.unsplash.com/photo-1540610410855-b4c8877b761c?auto=format&fit=crop&w=400&q=80",
                ubicacion: "Panamá, Panamá",
                precio: "Gratis",
                rating: "4.8",
                tipo: "Cultural",
                horario: "24 horas",
                ubicacion_mapa_url: "https://maps.google.com/?q=Casco+Viejo+Panama",
                favorito: false
            },
            {
                id: 3,
                nombre: "Parque Nacional Soberanía",
                descripcion: "Parque nacional que protege parte de la selva tropical panameña. Ideal para observación de aves, senderismo y conexión con la naturaleza.",
                imagen: "https://images.unsplash.com/photo-1518837695005-2083093ee35b?auto=format&fit=crop&w=400&q=80",
                ubicacion: "Panamá, Panamá",
                precio: "$60",
                rating: "4.8",
                tipo: "Naturaleza",
                horario: "6:00 AM - 6:00 PM",
                ubicacion_mapa_url: "https://maps.google.com/?q=Parque+Nacional+Soberania",
                favorito: true
            },
            {
                id: 4,
                nombre: "Esclusas de Miraflores",
                descripcion: "Centro de visitantes del Canal de Panamá. Observa el funcionamiento de las esclusas y aprende sobre la historia de esta maravilla de la ingeniería.",
                imagen: "https://images.unsplash.com/photo-1645932700624-5075c8d2df58?auto=format&fit=crop&w=400&q=80",
                ubicacion: "Panamá, Panamá",
                precio: "$18",
                rating: "4.9",
                tipo: "Cultural",
                horario: "8:00 AM - 6:00 PM",
                ubicacion_mapa_url: "https://maps.google.com/?q=Esclusas+Miraflores+Panama",
                favorito: true
            },
            {
                id: 5,
                nombre: "Isla Taboga",
                descripcion: "Conocida como la 'Isla de las Flores', esta hermosa isla ofrece playas pristinas, historia colonial y una escapada perfecta de la ciudad.",
                imagen: "https://images.unsplash.com/photo-1544551763-46a013bb70d5?auto=format&fit=crop&w=400&q=80",
                ubicacion: "Panamá, Taboga",
                precio: "$35",
                rating: "4.6",
                tipo: "Tropical",
                horario: "Ferries: 8:00 AM - 4:00 PM",
                ubicacion_mapa_url: "https://maps.google.com/?q=Isla+Taboga+Panama",
                favorito: false
            },
            {
                id: 6,
                nombre: "Cinta Costera",
                descripcion: "Parque lineal urbano que conecta el Casco Viejo con la ciudad moderna. Perfecto para caminar, correr y disfrutar de vistas panorámicas.",
                imagen: "https://images.unsplash.com/photo-1506905925346-21bda4d32df4?auto=format&fit=crop&w=400&q=80",
                ubicacion: "Panamá, Panamá",
                precio: "Gratis",
                rating: "4.2",
                tipo: "Urbano",
                horario: "24 horas",
                ubicacion_mapa_url: "https://maps.google.com/?q=Cinta+Costera+Panama",
                favorito: false
            },
            {
                id: 7,
                nombre: "Mercado de Mariscos",
                descripcion: "Mercado tradicional donde se puede degustar el mejor ceviche de la ciudad y otros platos típicos panameños con vista al mar.",
                imagen: "https://images.unsplash.com/photo-1565299624946-b28f40a0ca4b?auto=format&fit=crop&w=400&q=80",
                ubicacion: "Panamá, Panamá",
                precio: "$10-20",
                rating: "4.3",
                tipo: "Cultural",
                horario: "6:00 AM - 6:00 PM",
                ubicacion_mapa_url: "https://maps.google.com/?q=Mercado+Mariscos+Panama",
                favorito: true
            },
            {
                id: 8,
                nombre: "Parque Natural Metropolitano",
                descripcion: "Único parque natural urbano de América, ofrece senderos en medio de la selva tropical a solo minutos del centro de la ciudad.",
                imagen: "https://images.unsplash.com/photo-1441974231531-c6227db76b6e?auto=format&fit=crop&w=400&q=80",
                ubicacion: "Panamá, Panamá",
                precio: "$10",
                rating: "4.4",
                tipo: "Naturaleza",
                horario: "6:00 AM - 5:00 PM",
                ubicacion_mapa_url: "https://maps.google.com/?q=Parque+Metropolitano+Panama",
                favorito: true
            }
        ];

        // ============================================
        // FUNCIONES DE UTILIDAD
        // ============================================
        
        // Función para configurar manejo de errores de imágenes
        function setupImageErrorHandling() {
            document.querySelectorAll('img').forEach(img => {
                if (!img.hasAttribute('data-error-handled')) {
                    img.setAttribute('data-error-handled', 'true');
                    img.onerror = function() {
                        const w = this.width || 400;
                        const h = this.height || 300;
                        const txt = this.alt.charAt(0).toUpperCase() || '?';
                        this.src = `data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='${w}' height='${h}'%3E%3Crect width='${w}' height='${h}' fill='%23E0E6ED'/%3E%3Ctext x='50%25' y='50%25' font-size='48' fill='%237F8C8D' text-anchor='middle' alignment-baseline='middle'%3E${txt}%3C/text%3E%3C/svg%3E`;
                    };
                }
            });
        }

        // Función para obtener iconos según el tipo (usando Lucide)
        function getTypeIcon(tipo) {
            const typeIcons = {
                'naturaleza': 'tree-pine',
                'urbano': 'building-2', 
                'cultural': 'landmark',
                'tropical': 'palm-tree'
            };
            return typeIcons[tipo.toLowerCase()] || 'map-pin';
        }

        // ============================================
        // FUNCIÓN PRINCIPAL DE GENERACIÓN DE CARDS
        // ============================================
        
        // Función principal generateCardHTML (única función para generar cards)
        function generateCardHTML(place) {
            const url = `destino.html?id=${place.id}`;
            const priceText = place.precio ? place.precio : 'Gratis';
            
            return `
                <a href="${url}" class="destination-card" data-category="${place.tipo.toLowerCase()}">
                    <div class="destination-image">
                        <img src="${place.imagen}" alt="${place.nombre}" class="destination-img">
                    </div>
                    <div class="destination-info">
                        <div class="horizontal-info">
                            <h4 class="destination-name">${place.nombre}</h4>
                        </div>
                        <p class="destination-location">
                            <span class="location-icon"><i data-lucide="map-pin"></i></span>
                            ${place.ubicacion}
                        </p>
                        <p class="destination-type ${place.tipo.toLowerCase()}">${place.tipo}</p>
                        <div class="destination-meta">
                            <span class="rating">
                                <span class="star-icon"><i data-lucide="star" fill="currentColor"></i></span>
                                ${place.rating || '4.5'}
                            </span>
                            <span class="price">${priceText}</span>
                        </div>
                    </div>
                </a>
            `;
        }

        // ============================================
        // FUNCIÓN DE CARGA DE CONTENIDO
        // ============================================
        
        // Función para cargar destinos
        function loadDestinations() {
            const grid = document.querySelector('.destinations-grid');
            if (!grid) {
                console.log('No se encontró .destinations-grid');
                return;
            }

            // Limpiar grid existente
            grid.innerHTML = '';

            // Generar cartas usando generateCardHTML
            sitiosGuardados.forEach(destination => {
                const cardHTML = generateCardHTML(destination);
                grid.innerHTML += cardHTML;
            });

            // Configurar manejo de errores de imágenes
            setupImageErrorHandling();
            
            // Reinicializar iconos de Lucide
            if (typeof lucide !== 'undefined') {
                lucide.createIcons();
            }

            console.log('Destinos cargados:', sitiosGuardados.length);
        }

        // ============================================
        // FUNCIÓN DE INTERACCIÓN
        // ============================================
        
        // Función para alternar el estado de guardado/favorito
        function toggleSave(button) {
            const isSaved = button.dataset.saved === 'true';
            button.dataset.saved = !isSaved;
            
            // Cambiar el icono visual
            const heartIcon = button.querySelector('.heart-icon i, i');
            if (!isSaved) {
                button.classList.add('saved');
                if (heartIcon) {
                    heartIcon.classList.add('filled');
                }
            } else {
                button.classList.remove('saved');
                if (heartIcon) {
                    heartIcon.classList.remove('filled');
                }
            }

            // Reinicializar iconos
            if (typeof lucide !== 'undefined') {
                lucide.createIcons();
            }

            console.log('Toggled save state:', !isSaved);
        }

        // ============================================
        // FILTROS
        // ============================================
        
        // Función para filtrar destinos por tipo
        function filterDestinations(category) {
            const destinationCards = document.querySelectorAll('.destination-card');
            const noResults = document.getElementById('noResults');
            let visibleCards = 0;

            console.log('Filtrando destinos por categoría:', category);

            destinationCards.forEach((card, index) => {
                const cardCategory = card.dataset.category;
                
                // Resetear animación
                card.style.animation = 'none';
                card.style.animationDelay = '0s';

                let shouldShow = false;
                
                if (category === 'todos') {
                    shouldShow = true;
                } else {
                    shouldShow = cardCategory === category;
                }

                if (shouldShow) {
                    card.classList.remove('hidden');
                    card.style.display = 'block';
                    // Animación escalonada
                    setTimeout(() => {
                        card.style.animationDelay = `${visibleCards * 0.1}s`;
                        card.style.animation = 'fadeInUp 0.6s ease forwards';
                    }, 10);
                    visibleCards++;
                } else {
                    card.classList.add('hidden');
                    card.style.display = 'none';
                }
            });

            // Manejo de mensaje "no hay resultados"
            if (noResults) {
                noResults.style.display = visibleCards === 0 ? 'block' : 'none';
            }

            console.log('Destinos visibles:', visibleCards);
        }

        // ============================================
        // INICIALIZACIÓN DE FILTROS
        // ============================================
        
        // Función para inicializar los filtros de destinos
        function initializeDestinationFilters() {
            const tabButtons = document.querySelectorAll('.destinations-tabs .tab-btn');
            if (tabButtons.length === 0) {
                console.log('No se encontraron botones de filtro de destinos');
                return;
            }

            tabButtons.forEach(button => {
                button.addEventListener('click', function() {
                    // Remover clase active de todos los botones
                    tabButtons.forEach(btn => btn.classList.remove('active'));
                    // Añadir clase active al botón clickeado
                    this.classList.add('active');
                    
                    // Obtener categoría del data-category
                    const category = this.dataset.category;
                    filterDestinations(category);
                });
            });
        }

        // ============================================
        // INICIALIZACIÓN PRINCIPAL
        // ============================================
        
        // Función principal de inicialización
        function initializeAll() {
            try {
                // Cargar contenido
                loadDestinations();

                // Inicializar filtros
                initializeDestinationFilters();

                // Filtrar por defecto después de que se haya cargado el contenido
                setTimeout(() => {
                    filterDestinations('todos');
                }, 100);

                console.log('Aplicación inicializada correctamente');
            } catch (error) {
                console.error('Error al inicializar la aplicación:', error);
            }
        }

        // ============================================
        // EVENT LISTENERS
        // ============================================
        
        // Event listener para cuando se carga el DOM
        document.addEventListener('DOMContentLoaded', function() {
            try {
                // Inicializar Lucide Icons
                if (typeof lucide !== 'undefined') {
                    lucide.createIcons();
                }

                // Inicializar toda la aplicación
                initializeAll();
            } catch (error) {
                console.error('Error en DOMContentLoaded:', error);
            }
        });

        // Event listener global para botones de favorito
        document.addEventListener('click', function(e) {
            // Manejar clicks en botones de guardado
            if (e.target.closest('.save-btn')) {
                const button = e.target.closest('.save-btn');
                toggleSave(button);
                return;
            }
        });
    </script>
</body>
</html>